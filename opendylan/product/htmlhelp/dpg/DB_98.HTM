<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997 experimental) -->
<HEAD>
<LINK REL=TOP HREF="DB_1.HTM">
<LINK REL=UP HREF="DB_92.HTM">
<LINK REL=PREV HREF="DB_97.HTM">
<LINK REL=NEXT HREF="DB_99.HTM">
<TITLE>7.6   Meeting of angles and times</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997 experimental)">
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<DIV>
<A NAME=HEADING98></A>

<DIV>
<P><A HREF="DB_99.HTM"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="DB_97.HTM"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="DB_1.HTM"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="DB_2.HTM"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="DB_349.HTM"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
<A NAME=HEADING98-0></A>
<H1>7.6   <A NAME=MARKER-9-269></A>Meeting of angles and times</H1>
<P> We can create a new superclass to combine times and angles. Sometimes, the trickiest part of defining superclasses that model characteristics shared by other classes is thinking of the right name for the superclass. Here, we use <CODE>&lt;sixty-unit&gt;</CODE> to name the class that has <CODE>total-seconds</CODE> that can be converted to either hours, minutes, and seconds, or to degrees, minutes, and seconds. In the methods for decoding and encoding total seconds, we use the name <CODE>max-unit</CODE> to refer to the unit that is hours for time, and degrees for positions.</P>
<PRE>
define abstract class &lt;sixty-unit&gt; (&lt;object&gt;)
  slot total-seconds :: &lt;integer&gt;, init-keyword: total-seconds:;
end class &lt;sixty-unit&gt;;
define method decode-total-seconds 
    (sixty-unit :: &lt;sixty-unit&gt;)
 =&gt; (max-unit :: &lt;integer&gt;, minutes :: &lt;integer&gt;, seconds :: &lt;integer&gt;)
  decode-total-seconds(abs(sixty-unit.total-seconds));
end method decode-total-seconds;
define method encode-total-seconds 
    (max-unit :: &lt;integer&gt;, minutes :: &lt;integer&gt;, seconds :: &lt;integer&gt;) 
 =&gt; (total-seconds :: &lt;integer&gt;)
  ((max-unit * 60) + minutes) * 60 + seconds;
end method encode-total-seconds; 
</PRE>
<P> We redefine the time and angle classes and methods to take advantage of the new <CODE>&lt;sixty-unit&gt;</CODE> class:</P>
<PRE>
define abstract class &lt;time&gt; (&lt;sixty-unit&gt;)
end class &lt;time&gt;; 
define abstract class &lt;angle&gt; (&lt;sixty-unit&gt;)
end class &lt;angle&gt;; 
define method say (angle :: &lt;angle&gt;) =&gt; ()
  let(degrees, minutes, seconds) = decode-total-seconds(angle);
  format-out(&quot;%d degrees %d minutes %d seconds&quot;,
             degrees, minutes, seconds);
end method say; 
<I>// definition unchanged, repeated for completeness
</I>define abstract class &lt;directed-angle&gt; (&lt;angle&gt;)
  slot direction :: &lt;string&gt;, init-keyword: direction:;
end class &lt;directed-angle&gt;; 
define method say (angle :: &lt;directed-angle&gt;) =&gt; ()
  next-method();
  format-out(&quot; %s&quot;, angle.direction);
end method say; 
<I>// definition unchanged, repeated for completeness
</I>define class &lt;relative-angle&gt; (&lt;angle&gt;)
end class &lt;relative-angle&gt;;
<I>// we need to show degrees for &lt;relative-angle&gt;, but do not need to show
// minutes and seconds,so we override the method on &lt;angle&gt;
</I>define method say (angle :: &lt;relative-angle&gt;) =&gt; ()
  format-out(&quot; %d degrees&quot;, decode-total-seconds(angle));
end method say; 
define method say (position :: &lt;relative-position&gt;) =&gt; ()
  format-out(&quot;%d miles away at heading &quot;, position.distance);
  say(position.angle);
end method say; 
</PRE>
<P> </P>
<P> To see the complete library, and the test code that creates position instances and calls <CODE>say</CODE> on them, see <A HREF="DB_103.HTM#MARKER-9-278">Chapter 8,  <I>A Simple Library</I></A>.</P>
<P><A HREF="#MARKER-9-259">Figure 7.2</A> shows the inheritance relationships of the classes. When one class inherits from another, the relationship is sometimes called the <A NAME=MARKER-2-270></A><B>is-a relationship</B>. For example, a direct instance of <CODE>&lt;time-offset&gt;</CODE> <I>is a</I> <CODE>&lt;time&gt;</CODE> as well, and it <I>is a</I> <CODE>&lt;sixty-unit&gt;</CODE>.</P>
<TABLE BORDER=1><CAPTION><P>Figure 7.2   <A NAME=MARKER-9-259></A>Is-a relationships (inheritance) among classes, shown by arrows. Abstract classes are shown in <EM>oblique</EM> <EM>typewriter</EM> <EM>font.</EM></P>
</CAPTION><TR VALIGN=TOP><TD><P> <IMG ALIGN=TOP SRC=DB98IM14.GIF></P>
</TD></TR></TABLE><P>The classes have another kind of relationship as well -- one class can use another class as the type of a slot, in what is called the <A NAME=MARKER-2-271></A><B>has-a relationship</B>. <A HREF="#MARKER-9-260">Figure 7.3</A> shows both the inheritance relationships, and the relationships of one class using another class as the type of a slot.</P>
<P> </P>
<P>    </P>
<TABLE BORDER=1><CAPTION><P>Figure 7.3   <A NAME=MARKER-9-260></A>Has-a relationships among classes, shown by dashed arrows. </P>
</CAPTION><TR VALIGN=TOP><TD><P> <IMG ALIGN=TOP SRC=DB98IM15.GIF></P>
</TD></TR></TABLE>
</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>Dylan Programming - 9 Apr 1999</ADDRESS>
<P><A HREF="DB_99.HTM"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="DB_97.HTM"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="DB_1.HTM"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="DB_2.HTM"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="DB_349.HTM"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>N Feinberg/S E Keene/R Mathews/P Tucker Withington, DYLAN PROGRAMMING, (c) 1997 Harlequin Inc. Reproduced by permission of Addison-Wesley Longman Publishing Company, Inc.  All rights reserved. No further copying, downloading or transmitting of this material is allowed without the prior written permission of the publisher.</P>

</DIV>
</BODY>
</HTML>
